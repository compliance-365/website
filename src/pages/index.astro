---
import Base from '../layouts/BaseLayout.astro';
import Section from '../components/Section.astro';
import ctas from '../../content/globals/ctas.json';
import trust from '../../content/globals/trustbar.json';

const services = await Astro.glob('../../content/services/*.md');
const byTitle = (a,b) => a.frontmatter.title.localeCompare(b.frontmatter.title);
services.sort(byTitle);
const snippets = await Astro.glob('../../content/snippets/*.md');
const why = snippets.find(s => s.url?.includes('why-us'));
const evidence = snippets.find(s => s.url?.includes('automated-evidence-collection'));
---
<Base>
  <section style="max-width:1100px;margin:0 auto;padding:56px 20px 24px;display:grid;grid-template-columns:1.1fr .9fr;gap:24px;">
    <div>
      <h1 style="font-size:2.2rem;margin:0 0 12px">Audit‑ready compliance, simplified.</h1>
      <p class="muted" style="margin:0 0 18px">ISO 27001, ISO 42001, ISO 27701 & SOC 2 for Australian healthcare, government and SaaS — faster, with automation.</p>
      <div class="hero-btns">
        <a class="btn-primary" href={ctas.primaryUrl}>{ctas.primaryLabel}</a>
        <a class="btn-ghost" href={ctas.secondaryUrl}>{ctas.secondaryLabel}</a>
      </div>
      <div style="margin-top:18px" class="logobar">
        {trust.logos.map((l) => <span class="pill">{l}</span>)}
      </div>
    </div>
    <div class="card">
      {evidence && <>
        <h3>{evidence.frontmatter.title}</h3>
        <div set:html={evidence.compiledContent()} />
        <a class="btn-ghost" href="/services/iso-27001">See how it maps to ISO 27001 →</a>
      </>}
    </div>
  </section>

  <Section title="Services">
    <div class="grid-3">
      {services.map((s) => (
        <a class="card" href={s.url}>
          <h3 style="margin-top:0">{s.frontmatter.title}</h3>
          <p class="muted">{s.frontmatter.summary}</p>
          <span class="pill">Learn more →</span>
        </a>
      ))}
    </div>
  </Section>

  {why && <Section title={why.frontmatter.title}>
    <div class="card"><div set:html={why.compiledContent()} /></div>
  </Section>}
</Base>