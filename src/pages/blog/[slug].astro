---
import { getEntryBySlug } from 'astro:content';
import BlogLayout from '../../layouts/BlogLayout.astro';

export async function getStaticPaths() {
  const posts = await import.meta.glob('../../content/blog/*.md');
  return Object.keys(posts).map((path) => {
    const slug = path.split('/').pop()?.replace('.md', '');
    return { params: { slug } };
  });
}

const { slug } = Astro.params;
const post = await getEntryBySlug('blog', slug);
if (!post) throw new Error(`Post not found: ${slug}`);
---

<BlogLayout {...post.data}>
  {post.body}
</BlogLayout>
